import{c as ze,r as Ke,o as He,a as ot,p as lt,u as re,b as P,d,j as e,C as fe,B as u,T as l,G as M,F as Ce,e as De,f as Ae,M as _e,g as $e,A as Ue,S as Ve,h as R,i as D,E as ct,D as ie,k as oe,l as le,m as Y,n as X,q as J,s as Q,t as ce,P as Pe,v as xe,I as ue,w as pe,x as $,y as Ie,z as dt,H as ht,J as de,L as _,K as Be,N as mt,O as xt,Q as U,R as Z,U as O,V,W as ut,X as pt,Y as ft,Z as gt,_ as ge,$ as Ne,a0 as We,a1 as qe,a2 as jt,a3 as yt,a4 as bt,a5 as ae,a6 as vt,a7 as wt,a8 as St,a9 as Tt,aa as Ye,ab as Xe,ac as Fe,ad as G,ae as Je,af as Qe,ag as ne,ah as Ze,ai as kt,aj as et,ak as Ct,al as Dt,am as It,an as Wt,ao as Ft,ap as Et,aq as Mt,ar as Lt,as as Oe,at as ee,au as At,av as $t}from"./vendor-CrfWWC6e.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&c(h)}).observe(document,{childList:!0,subtree:!0});function s(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(a){if(a.ep)return;a.ep=!0;const o=s(a);fetch(a.href,o)}})();const Re=ze({palette:{mode:"dark",id:{main:"#20A79A",clip:He[900],background:"#FFFFFF"},timestamp:{main:"#8093E0"},lineground:{main:"#395553",clip:"#39254D"},primary:{main:"#20A79A",alt:"#71e2d7ff",background:"#FFFFFF"},secondary:{main:"#FFFFFF",background:"#17786E"},background:{main:"#424242",paper:"#202020"},error:{main:Ke.A400}}}),Ge=ze({palette:{mode:"light",id:{main:"#12645B",clip:He[900],background:"#22B9AA"},timestamp:{main:"#304BC5"},lineground:{main:"#89A5A3",clip:"#C5B4E3"},primary:{main:"#12645B",alt:"#0a3b36",background:"#FFFFFF"},secondary:{main:"#000000",background:"#22B9AA"},background:{main:"#17786E",paper:"#f5f5f5"},error:{main:Ke.A400}}}),Bt=t=>({searchText:"",setSearchText:r=>t({searchText:r}),streamer:"",setStreamer:r=>t({streamer:r}),streamType:[],setStreamType:r=>t({streamType:r}),fromDate:"",setFromDate:r=>t({fromDate:r}),toDate:"",setToDate:r=>t({toDate:r}),streamTitle:"",setStreamTitle:r=>t({streamTitle:r}),matchWholeWord:!1,setMatchWholeWord:r=>t({matchWholeWord:r})}),Ot=t=>({theme:"system",density:"standard",timeFormat:"relative",transcriptHeight:"100%",enableTagHelper:!1,defaultOffset:-20,sidebarOpen:!0,devMode:!1,membershipKey:"",membershipInfo:null,useVirtualList:!1,setTheme:r=>t({theme:r}),setDensity:r=>t({density:r}),setTimeFormat:r=>t({timeFormat:r}),setTranscriptHeight:r=>t({transcriptHeight:r}),setEnableTagHelper:r=>t({enableTagHelper:r}),setDefaultOffset:r=>t({defaultOffset:r}),setSidebarOpen:r=>t({sidebarOpen:r}),setDevMode:r=>t({devMode:r}),setMembershipKey:r=>t({membershipKey:r}),setMembershipInfo:r=>t({membershipInfo:r}),setUseVirtualList:r=>t({useVirtualList:r})}),b=ot()(lt((t,r,s)=>({...Bt(t),...Ot(t)}),{name:"live-transcript-settings",partialize:t=>({theme:t.theme,density:t.density,timeFormat:t.timeFormat,transcriptHeight:t.transcriptHeight,enableTagHelper:t.enableTagHelper,defaultOffset:t.defaultOffset,sidebarOpen:t.sidebarOpen,devMode:t.devMode,membershipKey:t.membershipKey,membershipInfo:t.membershipInfo,useVirtualList:t.useVirtualList})}));function Rt(){const t=re(),r=P("(max-width:599px)"),[s,c]=d.useState(""),[a,o]=d.useState(""),h=()=>{s.trim()&&t(`/transcript/${s.trim()}`)},m=()=>{a.trim()&&t(`/graph/${a.trim()}`)},y=n=>{n.key==="Enter"&&h()},v=n=>{n.key==="Enter"&&m()};return e.jsxs(fe,{maxWidth:"lg",sx:{minHeight:"80vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",py:4},children:[e.jsxs(u,{sx:{mb:6,textAlign:"center"},children:[e.jsx(l,{variant:r?"h3":"h2",component:"h1",color:"primary",fontWeight:"bold",sx:{background:n=>`linear-gradient(45deg, ${n.palette.primary.main}, ${n.palette.primary.alt})`,backgroundClip:"text",textFillColor:"transparent",mb:2},children:"Archived Transcripts"}),e.jsx(l,{variant:"h6",color:"text.secondary",sx:{maxWidth:600,mx:"auto"},children:"Search past streams or view specific transcripts."})]}),e.jsxs(M,{container:!0,spacing:4,justifyContent:"center",alignItems:"stretch",sx:{mb:6,maxWidth:800},children:[e.jsx(M,{size:{xs:12,sm:6},sx:{display:"flex"},children:e.jsx(Ce,{in:!0,timeout:500,children:e.jsx(De,{sx:{width:"100%",borderRadius:4,transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out","&:hover":{transform:"translateY(-8px)",boxShadow:n=>n.shadows[10]}},elevation:4,children:e.jsxs(Ae,{onClick:()=>t("/search"),sx:{height:"100%",p:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(u,{sx:{mb:2,p:2,borderRadius:"50%",bgcolor:"primary.light",color:"primary.contrastText",display:"flex"},children:e.jsx(_e,{fontSize:"large",sx:{fontSize:40}})}),e.jsxs($e,{sx:{p:0,textAlign:"center"},children:[e.jsx(l,{gutterBottom:!0,variant:"h5",component:"div",fontWeight:"medium",children:"Search"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"Search through all archived transcripts."})]})]})})})}),e.jsx(M,{size:{xs:12,sm:6},sx:{display:"flex"},children:e.jsx(Ce,{in:!0,timeout:700,children:e.jsx(De,{sx:{width:"100%",borderRadius:4,transition:"transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out","&:hover":{transform:"translateY(-8px)",boxShadow:n=>n.shadows[10]}},elevation:4,children:e.jsxs(Ae,{onClick:()=>t("/graph"),sx:{height:"100%",p:4,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(u,{sx:{mb:2,p:2,borderRadius:"50%",bgcolor:"secondary.light",color:"secondary.contrastText",display:"flex"},children:e.jsx(Ue,{fontSize:"large",sx:{fontSize:40}})}),e.jsxs($e,{sx:{p:0,textAlign:"center"},children:[e.jsx(l,{gutterBottom:!0,variant:"h5",component:"div",fontWeight:"medium",children:"Graph"}),e.jsx(l,{variant:"body2",color:"text.secondary",children:"View word count graphs for streams."})]})]})})})})]}),e.jsx(Ce,{in:!0,timeout:900,children:e.jsx(De,{sx:{p:4,borderRadius:4,maxWidth:600,width:"100%"},elevation:2,children:e.jsxs(Ve,{spacing:3,children:[e.jsx(l,{variant:"h6",fontWeight:"medium",align:"center",gutterBottom:!0,children:"Direct Access"}),e.jsxs(u,{sx:{display:"flex",gap:1,flexDirection:r?"column":"row"},children:[e.jsx(R,{fullWidth:!0,label:"View Transcript by ID",variant:"outlined",value:s,onChange:n=>c(n.target.value),onKeyDown:y,size:"small"}),e.jsx(D,{variant:"contained",onClick:h,disabled:!s.trim(),sx:{minWidth:80},children:"View"})]}),e.jsxs(u,{sx:{display:"flex",gap:1,flexDirection:r?"column":"row"},children:[e.jsx(R,{fullWidth:!0,label:"Graph Stream by ID",variant:"outlined",value:a,onChange:n=>o(n.target.value),onKeyDown:v,size:"small"}),e.jsx(D,{variant:"contained",color:"secondary",onClick:m,disabled:!a.trim(),sx:{minWidth:80},children:"Graph"})]})]})})}),e.jsxs(u,{sx:{mt:6,textAlign:"center"},children:[e.jsx(l,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:"Looking for active streams?"}),e.jsx(D,{href:"/live-transcript",variant:"outlined",size:"large",sx:{mt:1,borderRadius:2,px:4,textTransform:"none"},children:"Go to Live-Transcript"})]})]})}function Gt(){return e.jsxs(u,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",height:"50vh"},children:[e.jsx(ct,{color:"error",sx:{fontSize:60,mb:2}}),e.jsx(l,{variant:"h5",component:"h2",sx:{mb:1},children:"Archived Transcript is currently down for maintenance."}),e.jsx(l,{color:"text.secondary",children:window.maintenanceText1}),e.jsx(l,{color:"text.secondary",children:window.maintenanceText2})]})}const zt="/archived-transcript/assets/membership-setting-empty-light-BLpuD1rC.png",Kt="/archived-transcript/assets/membership-setting-set-light-BFpSlQrQ.png",Ht="/archived-transcript/assets/membership-example-stream-light-Cvt2m45H.png",_t="/archived-transcript/assets/search-empty-light-ae3s9cTI.png",Ut="/archived-transcript/assets/search-notext-light-DtWOKsXX.png",Vt="/archived-transcript/assets/search-text-light-B-aNugVU.png",Pt="/archived-transcript/assets/membership-setting-empty-dark-B_xuXG27.png",Nt="/archived-transcript/assets/membership-setting-set-dark-U7bfrawS.png",qt="/archived-transcript/assets/membership-example-stream-dark-DXvwav2E.png",Yt="/archived-transcript/assets/search-empty-dark-BSedxSU1.png",Xt="/archived-transcript/assets/search-notext-dark-mm0QIbfN.png",Jt="/archived-transcript/assets/search-text-dark-4wMiq-z3.png",te=({src:t,width:r="100%",alt:s=""})=>e.jsx(Pe,{elevation:3,sx:{my:2,p:.5,backgroundColor:"background.paper",border:"1px solid",borderColor:"divider",borderRadius:1,width:"fit-content",maxWidth:"100%",mx:"auto",overflow:"hidden",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx("img",{src:t,alt:s,style:{width:r,maxWidth:"100%",height:"auto",display:"block",margin:"0 auto"}})});function Qt({open:t,setOpen:r}){const s=b(m=>m.theme),c=P("(prefers-color-scheme: dark)"),a=s==="dark"||s==="system"&&c,o={membershipSettingEmpty:a?Pt:zt,membershipSettingSet:a?Nt:Kt,membershipExampleStream:a?qt:Ht,searchEmpty:a?Yt:_t,searchNoText:a?Xt:Ut,searchText:a?Jt:Vt},h=()=>{r(!1)};return e.jsx("div",{children:e.jsxs(ie,{open:t,onClose:h,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(oe,{id:"alert-dialog-title",children:"How to Use Archived Transcript"}),e.jsx(le,{children:e.jsxs("div",{children:[e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Settings"})}),e.jsxs(Q,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Settings are at the left of the page. Click the cogwheel icon to view the settings menu."}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"There are currently 3 settings. All settings are stored in local storage and persist across sessions."}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Theme: Select the color theme of the site. Light, Dark, or System default.",e.jsx("blockquote",{children:"System default will use whatever you set in your operating system. This is set by default."})]}),e.jsxs("li",{children:["Density: How much space should be between lines.",e.jsx("blockquote",{children:"Select whichever makes it easier to read."})]})]}),'The third setting is explained in the "Membership" section.']})]}),e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Sidebar"})}),e.jsxs(Q,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Allows you to easily jump between pages. Located on the left of your screen."}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Sidebar is broken up into 2 parts."}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Pages",e.jsx("blockquote",{children:"Select how you want to query the transcripts. Either search them, or graph them."})]}),e.jsxs("li",{children:["Other",e.jsx("blockquote",{children:"General options. View github url, open the help menu (this), or change the site settings."})]})]})]})]}),e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Search"})}),e.jsxs(Q,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:"You can search for when something was said and in what stream it was said in. You can also use filters to refine your search."}),e.jsx(te,{src:o.searchEmpty,alt:"Empty Search"}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:'Match Whole Word means it will not include any substrings of your search text. For example: say you search for "ball". If Match Whole Word is enabled, then it will only return results for "ball" and not "balls" or "baller".'}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"If search text is empty, then it will try to find all streams that match the filter, but return no text."}),e.jsx(te,{src:o.searchNoText,alt:"No Text Search"}),e.jsx("br",{}),e.jsxs(l,{variant:"body1",gutterBottom:!0,children:["Once the search has been completed, you will see a list of streams that fit the criteria. You can click on a stream to:",e.jsxs("ul",{children:[e.jsx("li",{children:"view contexts of your search text"}),e.jsx("li",{children:"Click a button to view the entire transcript for that stream"}),e.jsx("li",{children:"Click a button to graph that stream only"})]})]}),e.jsx(te,{src:o.searchText,alt:"Text Search"}),e.jsxs(l,{variant:"body1",gutterBottom:!0,children:["You can also click on the link button on a context line to:",e.jsxs("ul",{children:[e.jsx("li",{children:"Jump to the transcript at that timestamp"}),e.jsx("li",{children:"Copy the link to the stream at that timestamp"}),e.jsx("li",{children:"Open the stream at that timestamp in a new tab"})]})]})]})]}),e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Graph"})}),e.jsxs(Q,{children:[e.jsxs(l,{variant:"body1",gutterBottom:!0,children:["You can graph word or phase usage over time. There are two types of graph:",e.jsxs("ul",{children:[e.jsx("li",{children:"Across multiple streams"}),e.jsx("li",{children:"Across a single stream"})]})]}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:'The multi-stream graph can be accessed by clicking the graph button in the sidebar. The single-stream graph can only be accessed by clicking the "Graph This Stream" button on the search page.'}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Graphing functions the same as searching, with the only difference being you view a graph instead of a list of streams."}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Once graphed, you can switch between a cumulative sum or a rate over time (default)."})]})]}),e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Transcript"})}),e.jsxs(Q,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:'You can view the entire transcript for a stream by clicking the "View Full Transcript" button on the search page.'}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"The transcript view is the exact same as on Live-Transcript. You can click the link button on the left of a line to either open the stream at that timestamp or copy the link to it."})]})]}),e.jsxs(Y,{children:[e.jsx(X,{expandIcon:e.jsx(J,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:e.jsx(l,{children:"Membership"})}),e.jsxs(Q,{children:[e.jsx(l,{variant:"body1",gutterBottom:!0,children:"In order to search through members transcripts, you must have a valid key. Each streamer has their own key, and you can only use one key at a time. This means that you cannot search through members streams of multiple streamers at the same time."}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"To verify your key, go to settings"}),e.jsx(te,{src:o.membershipSettingEmpty,alt:"Empty Membership Setting"}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Enter the key, and click verify. If valid, it will be saved and you will see what streamer it is valid for, and when it expires."}),e.jsx(te,{src:o.membershipSettingSet,alt:"Membership Setting Set Successfully"}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"You can set a new key by deleting the key and verifying a new one."}),e.jsx(l,{variant:"body1",gutterBottom:!0,children:"Once the key is verified, you will be able to search through and graph members streams."}),e.jsx(te,{src:o.membershipExampleStream,alt:"Example Membership Stream"})]})]})]})}),e.jsx(ce,{children:e.jsx(D,{onClick:h,children:"Close"})})]})})}const tt="https://archive.duck-automata.com",Zt=20;async function he(t,r={}){const s={Accept:"application/json",...r.headers},c=b.getState().membershipKey;c&&(s["X-Membership-Key"]=c);const a=await fetch(`${tt}${t}`,{...r,method:"GET",headers:s});if(!a.ok){const o=`HTTP error ${a.status}: ${a.statusText}`,h=a.status;let m="";try{m=(await a.json()).error||o}catch{m=o}const y=new Error(m);throw y.status=h,y}return a.status===204?null:await a.json()}function Ee(t){if(!t)return"";const r=new URLSearchParams;Object.entries(t).forEach(([c,a])=>{a!=null&&(Array.isArray(a)?a.forEach(o=>r.append(c,o)):r.append(c,a.toString()))});const s=r.toString();return s?`?${s}`:""}async function er(t){if(!t)throw new Error("Transcript ID is required");return he(`/transcript/${t}`)}async function tr(t){const r=Ee(t);return he(`/transcripts${r}`)}async function rr(t,r={}){if(!t)throw new Error("Graph ID is required");const s={searchText:r.searchText,matchWholeWord:r.matchWholeWord},c=Ee(s);return he(`/graph/${t}${c}`)}async function sr(t){const r=Ee(t);return he(`/graph${r}`)}async function nr(t){return he(`/stream/${t}`)}async function ar(t){const r=await fetch(`${tt}/membership/verify`,{method:"GET",headers:{Accept:"application/json","X-Membership-Key":t}});if(!r.ok)throw r.status===401?new Error("Invalid membership key"):new Error(`Verification failed: ${r.statusText}`);return await r.json()}const rt=t=>{if(t==="")return;if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return null;const[r,s,c]=t.split("-").map(Number);return new Date(r,s-1,c).toLocaleString(void 0,{dateStyle:"medium"})},st=t=>{if(!t)return 0;try{const[r,s,c]=t.split(":").map(Number);return r*3600+s*60+c}catch{return 0}},ir=t=>{if(typeof t!="number"||isNaN(t))return"";const r=Math.floor(t/3600),s=Math.floor(t%3600/60),c=Math.floor(t%60),a=o=>o.toString().padStart(2,"0");return`${a(r)}:${a(s)}:${a(c)}`},or=t=>{if(!t)return"";const r=new Date(t);if(isNaN(r.getTime()))return"";const s=r.toLocaleString("default",{month:"long"}),c=r.getDate(),a=r.getFullYear(),h=`${c}${(S=>{const j=["th","st","nd","rd"],C=S%100;return j[(C-20)%10]||j[C]||j[0]})(c)}`,m=new Date,y=r.getTime()-m.getTime(),v=Math.ceil(y/(1e3*60*60*24));let n="";return v>0?n=` in ${v} day${v===1?"":"s"}`:v===0?n=" today":n=` ${Math.abs(v)} day${Math.abs(v)===1?"":"s"} ago`,`${s} ${h}, ${a} â€” ${n}`},lr=({open:t,setOpen:r})=>{const s=b(f=>f.theme),c=b(f=>f.density),a=b(f=>f.setTheme),o=b(f=>f.setDensity),h=b(f=>f.membershipKey),m=b(f=>f.membershipInfo),y=b(f=>f.setMembershipKey),v=b(f=>f.setMembershipInfo),[n,S]=d.useState(h),[j,C]=d.useState(!1),[w,i]=d.useState("");d.useEffect(()=>{S(h)},[h]);const x=async()=>{if(n.trim()){C(!0),i("");try{const f=await ar(n.trim());y(n.trim()),v(f)}catch(f){i(f.message)}finally{C(!1)}}},g=()=>{y(""),v(null),S(""),i("")},I=()=>{r(!1)},p=m?new Date(m.expiresAt)<new Date:!1;return e.jsxs(ie,{open:t,onClose:I,maxWidth:"xs",fullWidth:!0,children:[e.jsx(oe,{children:"Settings"}),e.jsxs(le,{children:[e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[e.jsxs(xe,{fullWidth:!0,variant:"filled",children:[e.jsx(ue,{id:"theme-select-label",children:"Theme"}),e.jsxs(pe,{labelId:"theme-select-label",name:"theme",value:s,onChange:f=>a(f.target.value),children:[e.jsx($,{value:"light",children:"Light"}),e.jsx($,{value:"system",children:"System"}),e.jsx($,{value:"dark",children:"Dark"})]})]}),e.jsxs(xe,{fullWidth:!0,variant:"filled",children:[e.jsx(ue,{id:"density-select-label",children:"Density"}),e.jsxs(pe,{labelId:"density-select-label",name:"density",value:c,onChange:f=>o(f.target.value),children:[e.jsx($,{value:"compact",children:"Compact"}),e.jsx($,{value:"standard",children:"Standard"}),e.jsx($,{value:"comfortable",children:"Comfortable"})]})]})]}),e.jsxs(u,{sx:{display:"flex",flexDirection:"column",gap:2,mt:3},children:[e.jsx(l,{variant:"h6",children:"Membership"}),m?e.jsxs(u,{sx:{p:2,border:"1px solid",borderColor:p?"error.main":"primary.main",borderRadius:1},children:[e.jsxs(u,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[p?e.jsx(Ie,{color:"error"}):e.jsx(dt,{color:"success"}),e.jsx(l,{variant:"subtitle1",fontWeight:"bold",color:p?"error":"inherit",children:p?"Expired Key":"Verified"})]}),e.jsxs(l,{variant:"body2",children:[e.jsx("b",{children:"Channel:"})," ",m.channel]}),e.jsxs(l,{variant:"body2",color:p?"error":"inherit",children:[e.jsx("b",{children:p?"Expired":"Expires"}),":"," ",or(m.expiresAt)]}),e.jsx(D,{variant:"outlined",color:"error",startIcon:e.jsx(ht,{}),onClick:g,sx:{mt:2},fullWidth:!0,children:"Delete Key"})]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{label:"Membership Key",variant:"outlined",fullWidth:!0,type:"text",value:n,onChange:f=>S(f.target.value),onKeyDown:f=>{f.key==="Enter"&&x()},error:!!w,helperText:w}),e.jsx(D,{variant:"contained",onClick:x,disabled:j||!n.trim(),fullWidth:!0,children:j?e.jsx(de,{size:24}):"Verify Key"})]})]})]}),e.jsx(ce,{children:e.jsx(D,{onClick:I,children:"Close"})})]})};function cr({children:t}){const r=re(),s=b(g=>g.sidebarOpen),c=b(g=>g.setSidebarOpen),[a,o]=d.useState(!1),[h,m]=d.useState(!1),[y,v]=d.useState(!1),n=P("(max-width:768px)"),S=n?180:200,j=60,C=[{name:"Search",icon:e.jsx(_e,{}),value:"search"},{name:"Graph",icon:e.jsx(Ue,{}),value:"graph"}],w=()=>{n?o(!a):c(!s)},i=()=>{x("/")},x=g=>{n&&o(!1),r(g)};return e.jsxs(u,{sx:{display:"flex"},children:[n&&!a&&e.jsx(u,{sx:{position:"fixed",top:10,left:10,zIndex:1200,backgroundColor:"background.paper",borderRadius:"50%",boxShadow:2},children:e.jsx(_,{onClick:()=>o(!0),sx:{borderRadius:"50%",p:1},children:e.jsx(Be,{})})}),e.jsx(mt,{open:n?a:!0,variant:n?"temporary":"persistent",onClose:n?()=>o(!1):void 0,sx:{width:n||s?S:j,flexShrink:0,"& .MuiDrawer-paper":{width:n||s?S:j,boxSizing:"border-box",overflowX:"hidden",transition:"width 0.3s ease-in-out"}},children:e.jsxs(u,{sx:{overflow:"hidden"},children:[e.jsxs(xt,{children:[e.jsx(U,{disablePadding:!0,children:e.jsxs(_,{onClick:w,sx:{justifyContent:!n&&!s?"center":"initial",px:2.5},children:[e.jsx(Z,{sx:{minWidth:0,mr:!n&&!s?"auto":3},children:e.jsx(Be,{})}),(!n&&s||n)&&e.jsx(O,{primary:""})]})}),e.jsx(U,{disablePadding:!0,children:e.jsx(V,{title:!n&&!s?"Home":"",placement:"right",children:e.jsxs(_,{onClick:i,sx:{justifyContent:!n&&!s?"center":"initial",px:2.5,overflow:"hidden"},children:[e.jsx(Z,{sx:{minWidth:0,mr:!n&&!s?"auto":3},children:e.jsx(ut,{})}),(!n&&s||n)&&e.jsx(O,{primary:"Home"})]})})}),!n&&!s&&e.jsx(U,{sx:{height:16}}),e.jsx(O,{primary:"Pages",sx:{mt:2,ml:1,display:!n&&s||n?"block":"none"}}),C.map(g=>e.jsx(U,{disablePadding:!0,children:e.jsx(V,{title:!n&&!s?g.name:"",placement:"right",children:e.jsxs(_,{selected:window.location.pathname.split("/")[3]===g.value,onClick:()=>x(g.value),sx:{justifyContent:!n&&!s?"center":"initial",px:2.5,overflow:"hidden"},children:[e.jsx(Z,{sx:{minWidth:0,mr:!n&&!s?"auto":3},children:g.icon}),(!n&&s||n)&&e.jsx(O,{primary:g.name})]})})},g.value)),e.jsx(U,{disablePadding:!0,sx:{mt:2},children:e.jsx(V,{title:"https://github.com/duckautomata/archived-transcript",placement:"right",children:e.jsxs(_,{onClick:()=>{window.open("https://github.com/duckautomata/archived-transcript","_blank","noopener noreferrer")},sx:{justifyContent:!n&&!s?"center":"initial",px:2.5,overflow:"hidden"},children:[e.jsx(Z,{sx:{minWidth:0,mr:!n&&!s?"auto":3},children:e.jsx(pt,{})}),(!n&&s||n)&&e.jsx(O,{primary:"GitHub"})]})})}),e.jsx(U,{disablePadding:!0,children:e.jsx(V,{title:!n&&!s?"Help":"",placement:"right",children:e.jsxs(_,{onClick:()=>m(!0),sx:{justifyContent:!n&&!s?"center":"initial",px:2.5,overflow:"hidden"},children:[e.jsx(Z,{sx:{minWidth:0,mr:!n&&!s?"auto":3},children:e.jsx(ft,{})}),(!n&&s||n)&&e.jsx(O,{primary:"Help"})]})})}),e.jsx(U,{disablePadding:!0,children:e.jsx(V,{title:!n&&!s?"Settings":"",placement:"right",children:e.jsxs(_,{onClick:()=>v(!0),sx:{justifyContent:!n&&!s?"center":"initial",px:2.5,overflow:"hidden"},children:[e.jsx(Z,{sx:{minWidth:0,mr:!n&&!s?"auto":3},children:e.jsx(gt,{})}),(!n&&s||n)&&e.jsx(O,{primary:"Settings"})]})})})]}),e.jsx(lr,{open:y,setOpen:v}),e.jsx(Qt,{open:h,setOpen:m})]})}),e.jsx(u,{component:"main",sx:{flexGrow:1,padding:1,width:n?"100%":`calc(97vw - ${s?S:j}px)`,transition:"width 0.3s ease-in-out, margin-left 0.3s ease-in-out"},children:t})]})}const dr=ge("span")(({theme:t})=>({color:t.palette.primary.main})),hr=ge("span")(({theme:t})=>({"&":{color:t.palette.timestamp.main}})),mr=d.memo(function({text:r,start:s,targetWord:c,margin:a,onActionClick:o}){const h=Ne(),m=b(w=>w.density),y=new RegExp(`(${c})`,"gi"),v=r.split(y),n=h.palette.id.main,S=m==="comfortable"?"medium":"small",j=m==="compact"?{padding:0}:{},C=()=>{o(s,r)};return e.jsxs(u,{sx:{display:"flex",alignItems:"center",mt:a,textAlign:"left"},children:[e.jsx(V,{title:"Line Actions",children:e.jsx(We,{size:S,sx:j,onClick:C,children:e.jsx(qe,{style:{color:n}})})})," ",e.jsxs(l,{component:"p",sx:{ml:1,wordBreak:"break-word"},children:["[",e.jsx(hr,{theme:h,children:s}),"]"," ",e.jsx("span",{children:v.map((w,i)=>y.test(w)?e.jsx(dr,{children:e.jsx("u",{children:w})},i):e.jsx("span",{children:w},i))})]})]})}),xr=d.memo(function({stream:r,targetWord:s,isExpanded:c,onToggle:a}){const o=re(),h=P("(max-width:768px)"),{id:m,streamer:y,date:v,streamType:n,title:S,contexts:j}=r,C=j.length,w=C===Zt,[i,x]=d.useState(!1),[g,I]=d.useState({timestamp:"",lineText:"",internalJumpUrl:"",externalVideoUrl:""}),[p,f]=d.useState(!1),[E,L]=d.useState(""),z=b(F=>F.density);let N=.5;z==="standard"?N=1.5:z==="comfortable"&&(N=2.5);const me=()=>{o(`/transcript/${m}`)},q=()=>{o(`/graph/${m}`)},se=d.useCallback((F,we)=>{let Se,Le;const Te=F.split(":");if(n==="Twitch"){const ke=`${Te[0]}h${Te[1]}m${Te[2]}s`;Se=`https://www.twitch.tv/videos/${m}?t=${ke}`}else{const ke=st(F);Se=`https://www.youtube.com/watch?v=${m}&t=${ke}s`}const it=F.replace(/:/g,"-");Le=`/transcript/${m}#T${it}`,I({timestamp:F,lineText:we,internalJumpUrl:Le,externalVideoUrl:Se}),x(!0)},[n,m]),K=()=>{x(!1),I({timestamp:"",lineText:"",internalJumpUrl:"",externalVideoUrl:""})},je=()=>{let F;n==="Twitch"?F=`https://www.twitch.tv/videos/${m}`:F=`https://www.youtube.com/watch?v=${m}`,L(F),f(!0)},B=()=>{f(!1)},ye=()=>{window.open(E,"_blank").focus(),f(!1)},be=()=>{g.internalJumpUrl&&o(g.internalJumpUrl),K()},ve=()=>{g.externalVideoUrl&&navigator.clipboard.writeText(g.externalVideoUrl),K()},W=()=>{g.externalVideoUrl&&window.open(g.externalVideoUrl,"_blank").focus(),K()};let T="#5e5e5eff",k=1;n==="Video"?(T="#0f2380ff",k=1):n==="Twitch"?(T="#6441a5",k=1):n==="TwitchVod"?(T="#FF41a5",k=1):n==="External"?(T="#af6c6cff",k=1):n==="Members"&&(T="#FFD700",k=2);const H={display:"block",cursor:"pointer",padding:"12px 16px"},A={padding:"16px",borderTop:k?`1px solid ${T}`:"none"},at=F=>{a(F.currentTarget.open)};return e.jsxs(u,{component:"details",onToggle:at,open:c,sx:{mb:N,borderRadius:4,border:k?`${k}px solid ${T}`:"none",overflow:"hidden"},children:[e.jsx("summary",{style:H,children:e.jsxs(u,{sx:{alignItems:"center",width:"100%",overflow:"hidden",display:"flex",flexWrap:h?"wrap":"nowrap"},children:[e.jsx(l,{variant:"body2",sx:{flexShrink:0,mr:2,color:"text.secondary"},children:rt(v)}),e.jsx(l,{variant:"body2",sx:{flexShrink:0,mr:2,color:"text.secondary"},children:y}),e.jsx(l,{variant:"body2",sx:{flexShrink:0,mr:2,color:T,fontWeight:"bold"},children:n}),e.jsx(l,{variant:"body2",sx:{flexGrow:1,mr:2,mt:h?1:0,width:h?"100%":"auto",order:h?1:0,noWrap:!0,textOverflow:"ellipsis"},children:S}),e.jsxs(l,{variant:"body2",sx:{width:"70px",flexShrink:0,mr:h?0:2,ml:h?"auto":0,color:"text.secondary",textAlign:"right"},children:[C," found"]})]})}),c&&e.jsxs("div",{style:A,children:[e.jsxs(Ve,{direction:h?"column":"row",spacing:2,sx:{mb:2,justifyContent:"center"},children:[e.jsx(D,{variant:"contained",size:"small",onClick:me,startIcon:e.jsx(jt,{}),sx:{flexShrink:0},children:"View Full Transcript"}),e.jsx(D,{variant:"contained",size:"small",onClick:q,startIcon:e.jsx(yt,{}),sx:{flexShrink:0},children:"Graph This Stream"}),e.jsx(D,{variant:"outlined",size:"small",onClick:je,startIcon:e.jsx(bt,{}),sx:{flexShrink:0},children:"Open This Stream"})]}),w&&e.jsx(l,{children:'Note: results may be limited. To see all results, click on "View Full Transcript"'}),n==="Members"&&e.jsx(l,{variant:"h6",color:"error",sx:{mb:2,mt:2,fontWeight:"bold",p:1,borderRadius:1},children:"This is members content and should only be used for personal use, never shared."}),j.map((F,we)=>e.jsx(mr,{start:F.startTime,text:F.line,targetWord:s,margin:N,onActionClick:se},`${m}-${F.startTime}-${we}`))]}),e.jsxs(ie,{open:i,onClose:K,"aria-labelledby":"line-action-dialog-title",children:[e.jsxs(oe,{id:"line-action-dialog-title",children:["Line Action [",g.timestamp,"]"]}),e.jsxs(le,{children:[e.jsxs(ae,{sx:{mb:2,fontStyle:"italic",wordBreak:"break-word"},children:['"',g.lineText,'"']}),e.jsx(ae,{children:"Choose an action for this line:"})]}),e.jsxs(ce,{sx:{display:"flex",flexDirection:"column",p:2,gap:2,"& > :not(style)":{marginLeft:"0 !important"}},children:[e.jsx(D,{onClick:be,variant:"outlined",fullWidth:!0,children:"Jump to Line in Transcript"}),e.jsx(D,{onClick:ve,variant:"outlined",fullWidth:!0,children:"Copy External Link"}),e.jsx(D,{onClick:W,variant:"contained",fullWidth:!0,autoFocus:!0,children:"Open External Link"}),e.jsx(D,{onClick:K,color:"inherit",fullWidth:!0,sx:{mt:1},children:"Cancel"})]})]}),e.jsxs(ie,{open:p,onClose:B,"aria-labelledby":"external-nav-dialog-title",children:[e.jsx(oe,{id:"external-nav-dialog-title",children:"Confirm External Navigation"}),e.jsxs(le,{children:[e.jsx(ae,{children:"You are about to be redirected to an external site."}),e.jsxs(ae,{sx:{mt:2,wordBreak:"break-all"},children:["URL: ",E]})]}),e.jsxs(ce,{children:[e.jsx(D,{onClick:B,children:"Cancel"}),e.jsx(D,{onClick:ye,variant:"contained",color:"primary",autoFocus:!0,children:"Proceed to Site"})]})]})]})});function Me({onSearch:t}){const r=b(o=>o.searchText),s=b(o=>o.setSearchText),c=d.useRef(null);d.useEffect(()=>{const o=h=>{(h.ctrlKey||h.metaKey)&&h.key==="f"?(h.preventDefault(),c.current&&(c.current.focus(),c.current.select())):h.key==="Escape"&&c.current&&document.activeElement===c.current&&c.current.blur()};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},[]);const a=o=>{o.key==="Enter"&&t&&t()};return e.jsx(u,{sx:{mb:4,p:2},children:e.jsx(M,{container:!0,spacing:2,alignItems:"center",children:e.jsx(M,{size:12,children:e.jsx(R,{inputRef:c,fullWidth:!0,label:"Search Text",variant:"outlined",value:r,onChange:o=>s(o.target.value),onKeyDown:a})})})})}function nt(){const t=b(i=>i.streamer),r=b(i=>i.streamType),s=b(i=>i.fromDate),c=b(i=>i.toDate),a=b(i=>i.streamTitle),o=b(i=>i.matchWholeWord),h=b(i=>i.setStreamer),m=b(i=>i.setStreamType),y=b(i=>i.setFromDate),v=b(i=>i.setToDate),n=b(i=>i.setStreamTitle),S=b(i=>i.setMatchWholeWord),j=["Dokibird","MintFantome"],C=["Video","Stream","Twitch","Members","TwitchVod","External"],w=i=>{const{target:{value:x}}=i;m(typeof x=="string"?x.split(","):x)};return e.jsxs(e.Fragment,{children:["Filter",e.jsx(u,{sx:{mb:4,p:2},children:e.jsxs(M,{container:!0,spacing:2,alignItems:"center",children:[e.jsx(M,{size:{xs:12,sm:6,md:3},children:e.jsxs(xe,{fullWidth:!0,sx:{minWidth:80},children:[e.jsx(ue,{id:"streamer-select-label",children:"Streamer"}),e.jsxs(pe,{labelId:"streamer-select-label",label:"Streamer",value:t,onChange:i=>h(i.target.value),children:[e.jsx($,{value:"",children:"Any"}),j.map(i=>e.jsx($,{value:i,children:i},i))]})]})}),e.jsx(M,{size:{xs:12,sm:6,md:3},children:e.jsxs(xe,{fullWidth:!0,sx:{minWidth:120},children:[e.jsx(ue,{id:"type-select-label",children:"Type"}),e.jsx(pe,{labelId:"type-select-label",multiple:!0,value:r,onChange:w,input:e.jsx(St,{label:"Type"}),renderValue:i=>e.jsx(u,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:i.map(x=>e.jsx(wt,{label:x,size:"small"},x))}),children:C.map(i=>e.jsxs($,{value:i,children:[e.jsx(vt,{checked:r.includes(i)}),e.jsx(O,{primary:i})]},i))})]})}),e.jsx(M,{size:{xs:12,sm:6,md:3},children:e.jsx(R,{fullWidth:!0,label:"From",type:"date",value:s,onChange:i=>y(i.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(M,{size:{xs:12,sm:6,md:3},children:e.jsx(R,{fullWidth:!0,label:"To",type:"date",value:c,onChange:i=>v(i.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(M,{size:{xs:12,sm:8},children:e.jsx(R,{fullWidth:!0,label:"Stream Title",variant:"outlined",value:a,onChange:i=>n(i.target.value)})}),e.jsx(M,{size:{xs:12,sm:4},children:e.jsx(Tt,{sx:{flexDirection:{xs:"column",sm:"row"},justifyContent:"center",gap:2},children:e.jsx(Ye,{control:e.jsx(Xe,{checked:o,onChange:i=>S(i.target.checked)}),label:"Match Whole Word"})})})]})})]})}function ur(){const t=b(Fe(x=>({searchText:x.searchText,streamer:x.streamer,streamType:x.streamType,fromDate:x.fromDate,toDate:x.toDate,streamTitle:x.streamTitle,matchWholeWord:x.matchWholeWord}))),[r,s]=d.useState(!1),[c,a]=d.useState(!1),[o,h]=d.useState(null),[m,y]=d.useState([]),[v,n]=d.useState(t.searchText),[S,j]=d.useState(new Set),C=m.length,w=d.useCallback(async()=>{a(!0),s(!0),h(null),y([]),j(new Set);try{const x=await tr(t);x&&x.result&&(y(x.result),n(t.searchText))}catch(x){h(x.message||"Failed to search transcripts.")}finally{a(!1)}},[t]),i=d.useCallback((x,g)=>{j(I=>{const p=new Set(I);return g?p.add(x):p.delete(x),p})},[]);return e.jsxs(fe,{sx:{padding:0},children:[e.jsxs(u,{sx:{my:4},children:[e.jsx(l,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:"Search Transcripts"}),e.jsx(Me,{onSearch:w}),e.jsx(nt,{}),e.jsx(D,{variant:"outlined",onClick:w,disabled:c,fullWidth:!0,children:c?"Searching...":"Search"})]}),e.jsxs(u,{sx:{mt:4},children:[c&&e.jsx(u,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx(de,{})}),o&&e.jsx(G,{severity:"error",sx:{my:2},children:o}),r&&!c&&!o&&C===0&&e.jsx(G,{severity:"info",sx:{my:2},children:"No data found for the selected criteria."}),C>0&&!c&&e.jsxs(u,{children:[e.jsxs(l,{variant:"body2",sx:{mb:2,textAlign:"center",color:"text.secondary"},children:["Found ",C," streams"]}),e.jsx(Je,{style:{height:"80vh",marginBottom:"40px"},data:m,itemContent:(x,g)=>e.jsx(xr,{stream:g,targetWord:v,isExpanded:S.has(g.id),onToggle:I=>i(g.id,I)},g.id)})]})]})]})}function pr(){const[t,r]=d.useState([]),[s,c]=d.useState(!1),[a,o]=d.useState(null),[h,m]=d.useState(null),[y,v]=d.useState(!1),[n,S]=d.useState(!1),j=b(Fe(i=>({searchText:i.searchText,streamer:i.streamer,streamType:i.streamType,fromDate:i.fromDate,toDate:i.toDate,streamTitle:i.streamTitle,matchWholeWord:i.matchWholeWord}))),C=d.useCallback(async()=>{if(v(!0),r([]),m(null),!j.searchText||j.searchText.trim()===""){o("Search text cannot be empty. Please enter a search term.");return}c(!0),o(null);try{const i=await sr(j);if(i&&i.result&&(r(i.result),i.result.length>0)){const x=i.result.reduce((I,p)=>I+p.y,0),g=Math.max(...i.result.map(I=>I.y));m({total:x,max:g})}}catch(i){o(i.message||"Failed to fetch graph data.")}finally{c(!1)}},[j]),w=d.useMemo(()=>{if(!n)return t.map(x=>{const[g,I,p]=x.x.split("-").map(Number);return{x:new Date(g,I-1,p),y:x.y}});let i=0;return t.map(x=>{const[g,I,p]=x.x.split("-").map(Number),f=new Date(g,I-1,p);return i+=x.y,{x:f,y:i}})},[t,n]);return e.jsx(fe,{sx:{padding:0},children:e.jsxs(u,{sx:{my:4},children:[e.jsx(l,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:"Graph Transcripts"}),e.jsx(Me,{onSearch:C}),e.jsx(nt,{}),e.jsx(D,{variant:"outlined",fullWidth:!0,onClick:C,disabled:s,children:s?"Graphing...":"Graph"}),e.jsxs(u,{sx:{mt:4},children:[s&&e.jsx(u,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx(de,{})}),a&&e.jsx(G,{severity:"error",sx:{my:2},children:a}),y&&!s&&!a&&t.length===0&&e.jsx(G,{severity:"info",sx:{my:2},children:"No data found for the selected criteria."}),t.length>0&&!s&&e.jsxs(u,{children:[e.jsx(Ye,{control:e.jsx(Xe,{checked:n,onChange:i=>S(i.target.checked)}),label:"Show Cumulative Sum",sx:{mb:1,display:"block"}}),h&&e.jsxs(u,{sx:{mb:2},children:[e.jsx(l,{variant:"h6",component:"h6",gutterBottom:!0,children:"Graph Statistics"}),e.jsxs(l,{variant:"body1",children:[e.jsx("b",{children:"Total Hits:"})," ",h.total.toLocaleString()]}),!n&&e.jsxs(l,{variant:"body1",children:[e.jsx("b",{children:"Max Hits (in one day):"})," ",h.max.toLocaleString()]})]}),e.jsx(u,{sx:{height:500,width:"100%"},children:e.jsx(Qe,{dataset:w,series:[{dataKey:"y",label:n?"Cumulative Count":"Count",showMark:!1,curve:"linear"}],xAxis:[{scaleType:"time",dataKey:"x",label:"Date",valueFormatter:i=>i?i.toLocaleString(void 0,{dateStyle:"medium"}):""}],yAxis:[{label:n?"Cumulative Count":"Count",min:0}],tooltip:{trigger:"axis"},grid:{vertical:!1,horizontal:!0}})})]})]})]})})}function fr(){const t=P("(max-width:768px)"),r=Math.max(Math.ceil((window.innerHeight-200)/36),1),s=Array.from(new Array(r));return e.jsxs(u,{sx:{height:"95vh",overflow:"hidden"},children:[e.jsxs(u,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(ne,{variant:"text",width:"90%",height:40,sx:{mb:1}}),e.jsx(l,{variant:"h5",color:"primary",sx:{mb:1},children:"Loading Transcript..."})]}),e.jsxs("div",{className:"transcript",children:[e.jsx(u,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center",mb:3},children:e.jsx(ne,{variant:"rounded",width:t?"100%":"50%",height:30})}),s.map((c,a)=>{const o=Math.max(1-a/s.length,.15);return e.jsxs(u,{sx:{display:"flex",alignItems:"center",mb:1.5,opacity:o},children:[e.jsx(ne,{variant:"circular",width:24,sx:{mr:1}}),e.jsx(ne,{variant:"text",width:80,sx:{mr:1}}),e.jsx(ne,{variant:"text",width:"100%"})]},a)})]})]})}const gr=ge("span")(({theme:t})=>({"&":{color:t.palette.timestamp.main}})),jr=ge("span")(({theme:t})=>({backgroundColor:t.palette.mode==="dark"?"rgba(255, 255, 0, 0.4)":"rgba(255, 255, 0, 0.8)",color:t.palette.mode==="dark"?"#fff":"#000",borderRadius:"2px",padding:"0 2px",textDecoration:"underline"})),yr=d.memo(function({id:r,start:s,text:c,searchTerm:a,handleClick:o}){const h=Ne(),m=b(j=>j.density),y=h.palette.id.main,v=m==="comfortable"?"medium":"small",n=m==="compact"?{padding:0}:{},S=d.useMemo(()=>{if(!a||!a.trim())return c;try{const j=new RegExp(`(${a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})`,"gi");return c.split(j).map((w,i)=>j.test(w)?e.jsx(jr,{children:w},i):w)}catch{return c}},[c,a]);return e.jsx(u,{id:r,sx:{padding:"1px 0","&:hover":{backgroundColor:h.palette.action.hover}},children:e.jsxs(l,{color:"secondary","aria-live":"assertive",whiteSpace:"pre-wrap",align:"left",style:{wordBreak:"break-word"},children:[e.jsx(V,{title:"Open video at timestamp",children:e.jsx(We,{size:v,sx:{...n,verticalAlign:"middle"},onClick:()=>o(s),children:e.jsx(qe,{style:{color:y}})})})," ","[",e.jsx(gr,{theme:h,children:s}),"] ",S]})})});function br(){const{id:t}=Ze(),r=re(),s=kt(),c=d.useRef(null),a=P("(max-width:768px)"),o=d.useRef(null),[h,m]=d.useState(""),[y,v]=d.useState(""),[n,S]=d.useState(""),[j,C]=d.useState(""),[w,i]=d.useState([]),[x,g]=d.useState(!0),[I,p]=d.useState(null),[f,E]=d.useState(!1),[L,z]=d.useState(""),[N,me]=d.useState(""),[q,se]=d.useState(""),K=w.filter(W=>W.text.toLowerCase().includes(q.toLowerCase())),je=d.useCallback(W=>{let T;const k=W.split(":");if(n==="Twitch"){const A=`${k[0]}h${k[1]}m${k[2]}s`;T=`https://www.twitch.tv/videos/${t}?t=${A}`}else{const A=+k[0]*3600+ +k[1]*60+ +k[2];T=`https://www.youtube.com/watch?v=${t}&t=${A}s`}const H=W.replace(/:/g,"-");me(`/transcript/${t}#T${H}`),z(T),E(!0)},[n,t]),B=()=>{E(!1),z(""),me("")},ye=()=>{se(""),r(N),B()},be=()=>{L&&navigator.clipboard.writeText(L),B()},ve=()=>{L&&window.open(L,"_blank").focus(),B()};return d.useEffect(()=>{let W=!0;async function T(){g(!0),p(null),i([]);try{const k=await er(t);W&&(m(k.date),v(k.streamTitle),S(k.streamType),C(k.streamer),i(k.transcriptLines||[]))}catch(k){W&&p({message:k.message||"Failed to fetch transcript data.",status:k.status||null})}finally{W&&g(!1)}}return T(),()=>{W=!1}},[t]),d.useEffect(()=>{if(x||w.length===0||!c.current||!s.hash||!s.hash.startsWith("#T"))return;const T=s.hash.substring(2).replace(/-/g,":");if(!T)return;const k=w.findIndex(A=>A.start===T),H=w[k]?.id;k===-1||!H||setTimeout(()=>{c.current&&(c.current.scrollToIndex({index:k,align:"start"}),setTimeout(()=>{const A=document.getElementById(H);A&&(A.classList.add("highlight"),setTimeout(()=>{document.getElementById(H)&&A.classList.remove("highlight")},2e3))},150))},100)},[x,w,s.hash]),d.useEffect(()=>{const W=T=>{(T.ctrlKey||T.metaKey)&&T.key==="f"?(T.preventDefault(),o.current&&(o.current.focus(),o.current.select())):T.key==="Escape"&&o.current&&document.activeElement===o.current&&o.current.blur()};return window.addEventListener("keydown",W),()=>{window.removeEventListener("keydown",W)}},[]),e.jsxs(u,{sx:{width:"100%"},children:[x?e.jsx(fr,{}):e.jsx(e.Fragment,{children:I?e.jsxs(u,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",height:"50vh"},children:[I.status===404?e.jsxs(e.Fragment,{children:[e.jsx(et,{color:"primary",sx:{fontSize:60,mb:2}}),e.jsx(l,{variant:"h5",component:"h2",sx:{mb:1},children:"404 Not Found"}),e.jsx(l,{color:"text.secondary",children:I.message})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ie,{color:"error",sx:{fontSize:60,mb:2}}),e.jsx(l,{variant:"h5",component:"h2",sx:{mb:1},children:"Error fetching transcripts"}),e.jsx(l,{color:"text.secondary",children:I.message})]}),e.jsx(D,{variant:"contained",onClick:()=>r("/"),sx:{mt:2},children:"Go Back Home"})]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:y}),n==="Members"&&e.jsx(Pe,{elevation:4,sx:{position:"sticky",top:0,zIndex:10,p:1.5,mb:2,border:"2px solid",borderColor:"error.main",borderRadius:2},children:e.jsxs(l,{variant:"h6",color:"error",sx:{fontWeight:"bold",textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[e.jsx(Ie,{})," This is members content and should only be used for personal use, never shared."]})}),e.jsxs(l,{sx:{mb:2},children:[rt(h)," - ",n," - ",j]}),e.jsxs(u,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center",mb:2},children:[e.jsx(R,{inputRef:o,label:"Search Transcript",variant:"outlined",size:"small",value:q,onChange:W=>se(W.target.value),slotProps:{input:{startAdornment:e.jsx(Ct,{position:"start",children:e.jsx(Dt,{})})}},sx:{width:a?"100%":"50%"}}),q&&e.jsx(We,{onClick:()=>{se("")},"aria-label":"clear search",children:e.jsx(It,{})})]}),e.jsx("hr",{}),e.jsx(Je,{ref:c,useWindowScroll:!0,style:{height:n==="Members"?a?"calc(100svh - 120px)":"calc(100vh - 250px)":a?"calc(100svh - 120px)":"calc(100vh - 180px)"},data:K,itemContent:(W,T)=>e.jsx(yr,{id:T.id,start:T.start,text:T.text,searchTerm:q,handleClick:je},T.id?`line-${T.id}`:`line-idx-${W}`)})]})}),e.jsxs(ie,{open:f,onClose:B,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(oe,{id:"alert-dialog-title",children:"Confirm External Navigation"}),e.jsxs(le,{children:[e.jsx(ae,{id:"alert-dialog-description",children:"You are about to open an external site in a new tab. Do you want to continue?"}),e.jsx(l,{variant:"body2",sx:{mt:2,wordBreak:"break-all",color:"text.secondary"},children:L})]}),e.jsxs(ce,{children:[e.jsx(D,{onClick:B,children:"Cancel"}),e.jsx(D,{onClick:ye,children:"Jump to line"}),e.jsx(D,{onClick:be,children:"Copy Instead"}),e.jsx(D,{onClick:ve,autoFocus:!0,children:"Continue"})]})]})]})}function vr(){const{id:t}=Ze(),r=re(),[s,c]=d.useState(null),[a,o]=d.useState(null),[h,m]=d.useState([]),[y,v]=d.useState(!1),[n,S]=d.useState(null),[j,C]=d.useState(null),[w,i]=d.useState(!1),x=b(Fe(p=>({searchText:p.searchText,streamer:p.streamer,streamType:p.streamType,from:p.fromDate,to:p.toDate,streamTitle:p.streamTitle,matchWholeWord:p.matchWholeWord})));d.useEffect(()=>{if(!t){o({message:"No transcript ID found in URL.",status:404});return}let p=!0;o(null);async function f(){try{const E=await nr(t);p&&c(E)}catch(E){p&&o({message:E.message||"Failed to fetch stream metadata.",status:E.status||null})}}return f(),()=>{p=!1}},[t]);const g=d.useCallback(async()=>{if(i(!0),m([]),C(null),!t){S("No transcript ID found in URL.");return}if(x.searchText===""){S("Search text cannot be empty. Please enter a search term.");return}v(!0),S(null);try{const p=await rr(t,x);if(p&&p.result){if(m(p.result),p.result.length>0){const f=p.result.reduce((L,z)=>L+z.y,0),E=Math.max(...p.result.map(L=>L.y));C({total:f,max:E})}}else m([])}catch(p){S(p.message||"Failed to fetch graph data.")}finally{v(!1)}},[t,x]),I=d.useMemo(()=>{if(!h.length)return[];let p=0;return h.map(f=>{const E=st(f.x);return p+=f.y,{x:E,y:p}})},[h]);return e.jsx(fe,{sx:{padding:0},children:a?.status===404?e.jsxs(u,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",height:"50vh"},children:[e.jsx(et,{color:"primary",sx:{fontSize:60,mb:2}}),e.jsx(l,{variant:"h5",component:"h2",sx:{mb:1},children:"404 Not Found"}),e.jsx(l,{color:"text.secondary",children:a.message}),e.jsx(D,{variant:"contained",onClick:()=>r("/"),sx:{mt:2},children:"Go Back Home"})]}):e.jsxs(u,{sx:{my:4},children:[e.jsx(l,{color:"primary",variant:"h5",component:"h5",sx:{mb:2,wordBreak:"break-word"},children:s?`Graph: ${s.streamTitle}`:"Graph Transcript"}),s&&e.jsxs(u,{sx:{mb:2,typography:"body2",color:"text.secondary",pl:.5},children:[s.streamType==="Members"&&e.jsx(l,{variant:"subtitle1",color:"error",sx:{mb:2,fontWeight:"bold",border:"1px solid red",p:1,borderRadius:1},children:"This is members content and should only be used for personal use, never shared."}),e.jsxs(l,{variant:"body2",children:[e.jsx("b",{children:"Streamer:"})," ",s.streamer," "," - ",e.jsx("b",{children:"Date:"})," ",s.date," "," - ",e.jsx("b",{children:"Type:"})," ",s.streamType]})]}),a&&e.jsx(G,{severity:"error",sx:{my:2},children:a}),e.jsx(Me,{}),e.jsx(D,{variant:"outlined",fullWidth:!0,onClick:g,disabled:y,children:y?"Graphing...":"Graph"}),e.jsxs(u,{sx:{mt:4},children:[y&&e.jsx(u,{sx:{display:"flex",justifyContent:"center",my:3},children:e.jsx(de,{})}),n&&e.jsx(G,{severity:"error",sx:{my:2},children:n}),w&&!y&&!n&&h.length===0&&e.jsx(G,{severity:"info",sx:{my:2},children:"No data found for the selected criteria."}),h.length>0&&!y&&e.jsxs(u,{children:[j&&e.jsxs(u,{sx:{mb:2},children:[e.jsx(l,{variant:"h6",component:"h6",gutterBottom:!0,children:"Graph Statistics"}),e.jsxs(l,{variant:"body1",children:[e.jsx("b",{children:"Total Hits:"})," ",j.total.toLocaleString()]})]}),e.jsx(u,{sx:{height:400,width:"100%"},children:e.jsx(Qe,{dataset:I,series:[{dataKey:"y",label:"Cumulative Count",showMark:!1,curve:"linear"}],xAxis:[{scaleType:"linear",dataKey:"x",label:"Time",valueFormatter:ir}],yAxis:[{label:"Cumulative Count",min:0}],tooltip:{trigger:"axis"},grid:{vertical:!1,horizontal:!0}})})]})]})]})})}const wr=(t=300*1e3)=>{const[r,s]=d.useState(!1),c=async()=>{try{const a=await fetch("/archived-transcript/version.json",{cache:"no-store"});if(!a.ok)return;const o=await a.json();o.buildTime>1769703875325&&(console.log("Update available!",o.buildTime,1769703875325),s(!0))}catch(a){console.error("Failed to check for updates:",a)}};return d.useEffect(()=>{c();const a=setInterval(c,t);return()=>clearInterval(a)},[t]),{updateAvailable:r}},Sr=()=>{const{updateAvailable:t}=wr(),r=re(),[s,c]=d.useState(!1),a=()=>{c(!0),r("/",{replace:!0}),setTimeout(()=>{window.location.reload(!0)},100)};return e.jsx(Wt,{open:t,anchorOrigin:{vertical:"top",horizontal:"center"},sx:{width:"90%",maxWidth:500,top:{xs:"12px !important",sm:"24px !important"},left:"50% !important",transform:"translateX(-50%) !important"},children:e.jsxs(G,{severity:"info",variant:"filled",icon:!1,sx:{alignItems:"center",width:"100%",backgroundColor:"#17786E",backdropFilter:"blur(8px)",color:"#FFFFFF",fontWeight:500,boxShadow:"0 4px 20px rgba(0,0,0,0.4)",borderRadius:"12px",border:"1px solid rgba(255, 255, 255, 0.2)"},action:e.jsx(D,{variant:"contained",size:"small",disabled:s,startIcon:s?e.jsx(de,{size:20,color:"inherit"}):e.jsx(Et,{}),onClick:a,sx:{backgroundColor:"#FFFFFF",color:"black",borderRadius:"8px",textTransform:"none",fontWeight:"bold",px:2,whiteSpace:"nowrap",boxShadow:"0 2px 10px rgba(0,0,0,0.3)","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.9)",boxShadow:"0 4px 12px rgba(0,0,0,0.4)"}},children:s?"Updating...":"Update"}),children:[e.jsx(Ft,{children:"Update Available"}),"Refresh the page or click the update button to update the website."]})})};function Tr(){const t=b(c=>c.theme);let s=P("(prefers-color-scheme: dark)")?Re:Ge;return t==="light"?s=Ge:t==="dark"&&(s=Re),e.jsxs(Mt,{theme:s,children:[e.jsx(Lt,{}),e.jsx(Sr,{}),window.maintenance?e.jsx(Oe,{children:e.jsx(ee,{path:"*",element:e.jsx(Gt,{})})}):e.jsx(e.Fragment,{children:e.jsx(cr,{children:e.jsxs(Oe,{children:[e.jsx(ee,{path:"*",element:e.jsx(Rt,{})}),e.jsx(ee,{path:"search/",element:e.jsx(ur,{})}),e.jsx(ee,{path:"graph/",element:e.jsx(pr,{})}),e.jsx(ee,{path:"graph/:id",element:e.jsx(vr,{})}),e.jsx(ee,{path:"transcript/:id",element:e.jsx(br,{})})]})})})]})}At.createRoot(document.getElementById("root")).render(e.jsx(d.StrictMode,{children:e.jsx($t,{basename:"archived-transcript",children:e.jsx(Tr,{})})}));
